"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[9285],{89285:(O,g,o)=>{o.r(g),o.d(g,{TicketNumberDetailPageComponent:()=>Q});var p=o(36895),r=o(24006),v=o(37094),x=o(83700),C=o(72506),m=o(44143),E=o(74713),T=o(76978),_=o(88001),D=o(28746),e=o(94650),b=o(344),F=o(82761),w=o(37735);function N(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"cf-select",20),e.NdJ("selectedChange",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.onProviderChange(n))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.provider)("data",t.providerSelectOption)("allowSearch",!1)}}const k=function(i){return{"opacity-50 pointer-events-none cursor-default":i}};function A(i,s){if(1&i&&e._UZ(0,"cf-select",21),2&i){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.supplier)("data",t.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(4,k,t.isDisableSupplier))}}function Z(i,s){if(1&i&&e._UZ(0,"cf-select",22),2&i){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.ticketType)("data",t.ticketTypeSelectOption)("allowSearch",!1)}}function S(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"cf-select",30),e.NdJ("selectedChange",function(n){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onProviderChange(n))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("formControl",t.searchForm.controls.provider)("data",t.providerSelectOption)("allowSearch",!1)}}function I(i,s){if(1&i&&e._UZ(0,"cf-select",31),2&i){const t=e.oxw(2);e.Q6J("formControl",t.searchForm.controls.supplier)("data",t.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(4,k,t.isDisableSupplier))}}function y(i,s){if(1&i&&e._UZ(0,"cf-select",32),2&i){const t=e.oxw(2);e.Q6J("formControl",t.searchForm.controls.ticketType)("data",t.ticketTypeSelectOption)("allowSearch",!1)}}function P(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",23)(1,"div",24),e.YNc(2,S,1,3,"cf-select",25),e.YNc(3,I,1,6,"cf-select",26),e.YNc(4,y,1,3,"cf-select",27),e.TgZ(5,"cf-input-group",7),e._UZ(6,"cf-icon",8)(7,"input",9),e.qZA()(),e.TgZ(8,"div")(9,"button",28),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileSearch())}),e._UZ(10,"cf-icon",29),e.TgZ(11,"div"),e._uU(12,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.isShowProvider),e.xp6(1),e.Q6J("ngIf",t.isShowProvider),e.xp6(1),e.Q6J("ngIf",t.isShowProvider),e.xp6(1),e.Q6J("status","default"),e.xp6(2),e.Q6J("formControl",t.searchForm.controls.ticketNumber)}}function U(i,s){1&i&&(e.TgZ(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36)(4,"div",37),e._UZ(5,"img",38),e.qZA(),e.TgZ(6,"div",39),e._uU(7," Nh\u1eadp s\u1ed1 v\xe9 "),e.qZA(),e.TgZ(8,"div",40),e._uU(9," Vui l\xf2ng nh\u1eadp s\u1ed1 v\xe9 c\u1ee7a b\u1ea1n v\xe0o \xf4 b\xean tr\xean v\xe0 ch\u1ecdn n\xfat "),e.TgZ(10,"span",41),e._uU(11,"T\xecm ki\u1ebfm"),e.qZA(),e._uU(12," \u0111\u1ec3 b\u1eaft \u0111\u1ea7u "),e.qZA()()()()())}function J(i,s){1&i&&(e.TgZ(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36)(4,"div",37),e._UZ(5,"img",42),e.qZA(),e.TgZ(6,"div",39),e._uU(7," Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 "),e.qZA(),e.TgZ(8,"div",43)(9,"div"),e._uU(10,"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 \u0111\u1ec3 hi\u1ec3n th\u1ecb"),e.qZA(),e.TgZ(11,"div"),e._uU(12,"Vui l\xf2ng th\u1eed l\u1ea1i sau ho\u1eb7c ki\u1ec3m tra l\u1ea1i th\xf4ng tin s\u1ed1 v\xe9"),e.qZA()()()()()())}function B(i,s){1&i&&(e.TgZ(0,"div",44),e._UZ(1,"ticket-item-skeleton")(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton"),e.qZA())}function z(i,s){if(1&i&&(e.TgZ(0,"div",45),e._UZ(1,"div",46),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("innerHTML",t.ticketDetail.ticketImage,e.oJD)}}let Q=(()=>{class i{constructor(t,l,n,c,u){this._fb=t,this._manageBookingService=l,this._bottomSheetService=n,this._router=c,this._permissionService=u,this.airline="VN",this.isLoading=!1,this.state="SEARCH",this.isShowProvider=this._permissionService.isAgent1()||this._permissionService.isBooker(),this.isDisableSupplier=!1,this.providerSelectOption=[],this.supplierSelectOption=[],this.ticketTypeSelectOption=[]}ngOnInit(){this.searchForm=this._fb.group({provider:["VN",this.isShowProvider?r.kI.required:null],supplier:[""],ticketNumber:["",this.isShowProvider?r.kI.required:null],ticketType:["",this.isShowProvider?r.kI.required:null]}),this.providerSelectOption=[{text:"Vietnam Airlines",value:_.QK.VN}],this.supplierSelectOption=[...Object.entries(_.f$).map(([t,l])=>({text:t,value:l}))],this.ticketTypeSelectOption=[{text:"V\xe9",value:"FARE"},{text:"H\xe0nh l\xfd",value:"BAG"},{text:"Ch\u1ed7 ng\u1ed3i",value:"SEAT"}]}getTicketDetail(){var t;if(this.searchForm.invalid)return;const l=this.searchForm.value,n={provider:l.provider||"",supplier:l.supplier?l.supplier:null,ticketNumber:null===(t=l.ticketNumber)||void 0===t?void 0:t.trim(),ticketType:l.ticketType};this.state="LOADING",this._manageBookingService.getTicketDetail(n).pipe((0,D.x)(()=>this.isLoading=!1)).subscribe({next:c=>{c.success?(this.state="SUCCESS",this.ticketDetail=this.proccessTicketDetail(c.data)):this.state="EMPTY"},error:()=>{this.state="EMPTY"}})}proccessTicketDetail(t){var l,n,c,u,d,f,h;return{ticketNumber:"",ticketImage:t.ticketImage,passengerName:t.ticketInfo.passengerName,ticketInfo:{numCoupons:t.ticketInfo.numCoupons,issueDate:t.ticketInfo.issueDate,createDate:t.ticketInfo.createDate,bookingCode:t.ticketInfo.prn},segments:t.segment.map(a=>({number:a.number,airline:a.marketingAirline,flightNumber:a.flightNumber,classCode:a.bookingClassCode,date:a.departureDate,brdoff:a.originLocation+a.destinationLocation,time:a.departureTime,status:a.segmentStatus,fareBasis:a.fareBasis,statusCode:a.ticketStatus,baggageAllowance:a.baggageAllowance})),pricingInfo:{baseFare:t.pricingInfo.baseFare.currencyCode.concat(" ",t.pricingInfo.baseFare.amount),taxes:t.pricingInfo.taxes.map(a=>a.amount.concat(a.taxCode)).join(" "),totalFare:t.pricingInfo.totalFare.currencyCode.concat(" ",t.pricingInfo.totalFare.amount)},fareCalc:t.pricingInfo.fareCalculation,paymentInfo:{paymentCardNumber:null===(l=t.paymentInfo)||void 0===l?void 0:l.paymentCardNumber,authorizationCode:null===(n=t.paymentInfo)||void 0===n?void 0:n.authorizationCode},ticketData:{issueDate:(null===(c=t.ticketData)||void 0===c?void 0:c.issueDate)||"",printStation:(null===(u=t.ticketData)||void 0===u?void 0:u.printStation)||"",issuingAgent:(null===(d=t.ticketData)||void 0===d?void 0:d.issuingAgent)||"",remarks:(null===(f=t.ticketData)||void 0===f?void 0:f.remarks)||"",endorsements:(null===(h=t.ticketData)||void 0===h?void 0:h.endorsements.join(""))||""}}}_getCurrentUrl(){return`${window.location.origin}/admin/booking-detail/${this.airline}/${this.ticketDetail.ticketInfo.bookingCode}`}onOpenBookingCode(){window.open(this._getCurrentUrl())}onMobileOpenBookingCode(){this._router.navigate([`/admin/booking-detail/${this.airline}/${this.ticketDetail.ticketInfo.bookingCode}`])}onMobileSearch(){this._bottomSheetService.dismiss(),this.getTicketDetail()}openSearchBts(t){const l=this._bottomSheetService.open(t,{headerTitle:"T\xecm ki\u1ebfm",rightButtonIcon:"",leftButtonIcon:"close",containerFullHeigh:!0,leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});l.containerInstance._leftButtonClick.subscribe(()=>l.dismiss())}onProviderChange(t){this.isDisableSupplier="VN"!==t.value}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.qu),e.Y36(b.fB),e.Y36(v.a2),e.Y36(F.F0),e.Y36(w.$A))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ticket-number-detail-page"]],standalone:!0,features:[e.jDz],decls:27,vars:10,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]","md:hidden"],[1,"text-heading-lg"],[1,"flex","items-stretch","gap-x-4"],["class","w-[260px]","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",3,"formControl","data","allowSearch","selectedChange",4,"ngIf"],["class","w-[260px]","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",3,"formControl","data","allowSearch","ngClass",4,"ngIf"],["class","w-[260px]","placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",3,"formControl","data","allowSearch",4,"ngIf"],[1,"!w-full",3,"status"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm t\xecm ki\u1ebfm theo s\u1ed1 v\xe9",3,"formControl"],["cf-button","","size","medium","type","secondary",1,"w-[260px]","justify-center",3,"disabled","click"],["icon","search","size","small",1,"pr-3"],[1,"hidden","md:flex","flex-col","py-3","px-4","gap-y-3","pr-0","bg-neutral-white"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"hidden","!w-full","md:pr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"focus"],["searchBts",""],["class","flex-auto w-full max-h-[calc(100vh-152px)] py-4 px-[30px]",4,"ngIf"],["class","p-6",4,"ngIf"],["class","px-6 py-4 md:p-4 md:pb-[90px]",4,"ngIf"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",1,"w-[260px]",3,"formControl","data","allowSearch","selectedChange"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-[260px]",3,"formControl","data","allowSearch","ngClass"],["placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",1,"w-[260px]",3,"formControl","data","allowSearch"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],["class","w-full max-w-full","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",3,"formControl","data","allowSearch","selectedChange",4,"ngIf"],["class","w-full max-w-full","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",3,"formControl","data","allowSearch","ngClass",4,"ngIf"],["class","w-full max-w-full","placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",3,"formControl","data","allowSearch",4,"ngIf"],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",1,"w-full","max-w-full",3,"formControl","data","allowSearch","selectedChange"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-full","max-w-full",3,"formControl","data","allowSearch","ngClass"],["placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",1,"w-full","max-w-full",3,"formControl","data","allowSearch"],[1,"flex-auto","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]"],[1,"bg-white","w-full","h-full","rounded-lg","md:bg-transparent"],[1,"h-[500px]","flex","flex-col","justify-center","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"mb-8"],["src","assets/images/web-page.svg","alt",""],[1,"text-heading-md","text-neutral-black","mb-2"],[1,"text-espressive-md","text-neutral-gray-5","md:text-center"],[1,"text-espressive-md"],["src","assets/images/empty-result.svg","alt",""],[1,"text-body-md-short","text-neutral-gray-5","text-center"],[1,"p-6"],[1,"px-6","py-4","md:p-4","md:pb-[90px]"],[1,"p-6","bg-neutral-white","rounded-lg","text-body-md","whitespace-pre-wrap",3,"innerHTML"]],template:function(t,l){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"M\u1edf s\u1ed1 v\xe9"),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,N,1,3,"cf-select",4),e.YNc(6,A,1,6,"cf-select",5),e.YNc(7,Z,1,3,"cf-select",6),e.TgZ(8,"cf-input-group",7),e._UZ(9,"cf-icon",8)(10,"input",9),e.qZA(),e.TgZ(11,"button",10),e.NdJ("click",function(){return l.getTicketDetail()}),e._UZ(12,"cf-icon",11),e._uU(13," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(14,"div",12)(15,"div",13),e._uU(16,"M\u1edf s\u1ed1 v\xe9"),e.qZA(),e.TgZ(17,"cf-input-group",14),e._UZ(18,"cf-icon",8),e.TgZ(19,"input",15),e.NdJ("focus",function(){e.CHM(n);const u=e.MAs(21);return e.KtG(l.openSearchBts(u))}),e.qZA()()(),e.YNc(20,P,13,5,"ng-template",null,16,e.W1O),e.TgZ(22,"div"),e.YNc(23,U,13,0,"div",17),e.YNc(24,J,13,0,"div",17),e.YNc(25,B,5,0,"div",18),e.YNc(26,z,2,1,"div",19),e.qZA()()}2&t&&(e.xp6(5),e.Q6J("ngIf",l.isShowProvider),e.xp6(1),e.Q6J("ngIf",l.isShowProvider),e.xp6(1),e.Q6J("ngIf",l.isShowProvider),e.xp6(1),e.Q6J("status","default"),e.xp6(2),e.Q6J("formControl",l.searchForm.controls.ticketNumber),e.xp6(1),e.Q6J("disabled",l.searchForm.invalid||"LOADING"===l.state),e.xp6(12),e.Q6J("ngIf","SEARCH"===l.state),e.xp6(1),e.Q6J("ngIf","EMPTY"===l.state),e.xp6(1),e.Q6J("ngIf","LOADING"===l.state),e.xp6(1),e.Q6J("ngIf","SUCCESS"===l.state))},dependencies:[p.ez,p.mk,p.O5,r.u5,r.Fj,r.JJ,m.j$,m.ND,m.BN,C.AxE,C.Sm8,x.N8,x.Xq,T.IA,r.UX,r.oH,v.DW,E.q],encapsulation:2}),i})()}}]);